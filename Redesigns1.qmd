---
title: "Redesign of CDC Opioid Map"
---

# Original State Map of Opioid Dispensing Rates

![](State%20Opiod%20Dispensing%20Rates%202023.png){fig-align="left" width="511"}

The map shows retail pharmacy dispensed opioid prescriptions per 100 persons per year in 2019 and 2023. The current CDC map of opioid dispensing rates uses four fixed categories (\<34.9, 34.9–42.0, 42.1–51.7, \>51.7). While simple, this approach has several key problems:

-   **Obscures variation:** The top category (\>51.7) lumps together rates from 52 to 71. This means states with moderately high rates and those with extremely high rates appear identical, hiding important differences.

    -   For example, in 2023, **Kansas** had a dispensing rate of **52.8**, while **Arkansas** was much higher at **71.5** — yet both appear identical on the map.

-   **Ignores change over time:** The map only shows a single year and does not reveal how rates have changed from 2019 to 2023, preventing understanding of trends or improvements across states.

-   **Static thresholds distort trends:** Using the same cutoffs across years can make overall increases or decreases invisible, since many states may shift within a category without any visual change on the map.

-   **Color choice issues:** Using only a few discrete colors for broad categories reduces the map’s ability to reflect subtle differences, making it harder to distinguish states with similar rates or identify regional patterns.

    Overall, the current map’s categorical bins and limited color scheme oversimplify the data and fail to communicate both the magnitude of high rates and temporal trends, making it less useful for analysis or policy insights.

# **📊Stacked Bar Graph Redesign**

```{r}
#| include: false
#Download Library
library(tidyverse)
library(ggplot2)
library(scales)
library(plotly)

#Import Dataset
OpioidData = read.csv("C:/Users/Sean/Desktop/State Opioid Dispensing Rates.csv") #make sure its forward slash

#CreatingDataset
long_data <- OpioidData %>%
  filter(YEAR %in% c(2019, 2023)) %>%
  rename(Year = YEAR, Rate = opioid_dispensing_rate) %>%
  group_by(STATE_NAME, STATE_ABBREV) %>%
  mutate(
    pct_change = round((Rate[Year == 2023] - Rate[Year == 2019]) / Rate[Year == 2019] * 100)) #round is nearest .1 #trying to add percent change

# Makes the graph go Descending
ordered_states <- long_data %>%
  filter(Year == 2019) %>%
  arrange(desc(Rate)) %>%
  pull(STATE_ABBREV)

long_data$STATE_ABBREV <- factor(long_data$STATE_ABBREV, levels = ordered_states)


stackedbar <- ggplot() +
  # 2019 bars (red - bad)
  geom_col(
    data = long_data %>% filter(Year == 2019),
    aes(x = STATE_ABBREV, y = Rate, Year = "2019"),
    fill = "red", alpha = 0.4, width = 0.6
  ) +
  # 2023 bars (blue)
  geom_col(
    data = long_data %>% filter(Year == 2023),
    aes(x = STATE_ABBREV, y = Rate, Year = "2023"),
    fill = "blue", width = 0.6
  ) +
  labs(
    x = "State",
    y = "Opioid Dispensing Rate",
    title = "Opioid Dispensing Rates by State",
    subtitle ="2023 Blue"
  ) +
  
    scale_fill_manual(
    values = c("2019" = "red", "2023" = "blue"),
    labels = c("2019" = "Year 2019", "2023" = "Year 2023")
  )+
  theme_minimal() +coord_flip()

(stackedbar)

plotlycoverted <- ggplotly (stackedbar)
```

```{r}
#| echo: false
(plotlycoverted)
```

The stacked bar graph compares **opioid dispensing rates** between **2019 and 2023** for each state, highlighting how rates have changed over time.

You can **toggle between 2019, 2023, or view both years together** to see trends more clearly.\
This design highlights both the **absolute rates**, making it easy to see which states made the greatest progress and which showed minimal change or slight increases.

The visualization helps viewers quickly identify national patterns and understand how opioid dispensing rates have shifted over the four-year period.

**Key Features:**

-   Highlights the **decrease** in opioid dispensing rates over time.

-   You can quickly identify **which states had the largest decreases**, as well as states with minimal change or slight increases.

-   Provides a **direct, data-driven view** of national trends and state-level progress.

# **🗺️ Heat Map Redesign**

```{r}
#| include: false
#| 
library(plotly)
library(dplyr)
library(tidyr)
library(usmap)

MapRedesign <- read.csv("C:/Users/Sean/Desktop/State Opioid Dispensing Rates.csv") %>%
  filter(YEAR %in% c(2019, 2023))

#adds 2019 & 2023 columns
BothYears <- MapRedesign %>%
  select(STATE_NAME, STATE_ABBREV, YEAR, opioid_dispensing_rate) %>%
  pivot_wider(names_from = YEAR, values_from = opioid_dispensing_rate) %>%
  rename(state = STATE_NAME)  

#creates the map
mapOp <- plot_usmap(data = BothYears, values = "2019") +
  scale_fill_continuous(
    name = "Opioid Rates 2019",
    low = "#FFE5E5",
    high = "#CC0000",
    label = scales::comma
  ) +
  theme(legend.position = "right") +
  ggtitle("US Opioid Dispensing Rates by State (2019)")

#More interactive with hover and plotly
# Create hover text
BothYears$hover <- paste0(
  "<b>State:</b> ", BothYears$STATE_NAME, "<br>",
  "<b>2019 Rate:</b> ", BothYears$`2019`
)

# Convert to interactive Plotly
mapOp_interactive <- ggplotly(mapOp, tooltip = "fill")

mapOp_interactive
```

```{r}
#| echo: false
#| message: false
#| warning: false
#| paged-print: false
(mapOp_interactive)
```

The heat map visualizes **opioid dispensing rates** across the U.S., using color intensity to show severity — the darker the red, the more severe the rate in that state.

**Key Features:**

-   **Red indicates higher rates**, with darker red showing the most severe dispensing levels.

-   Uses a **continuous color scale** instead of categories, showing the full range of values.

-   Makes it easier to **identify regional clusters** of high opioid dispensing.

-   Highlights **where opioid dispensing is most concentrated** across the country.

-   Provides a **more detailed and nuanced view** than the original CDC map.
